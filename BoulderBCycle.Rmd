```{r, warning = FALSE}
library(ggplot2)
library(caret)
library(ggmap)
```

## Summarize data
```{r, warning = FALSE}
# Load the dataset 
dataset <- read.csv("Boulder Data.csv", header = TRUE)

# It looks like RTD and 14th and Canyon are supposed to mean the same location, so 
# search and replace. This is okay because our analysis about stations doesn't change
# as 14th and Canyon/RTD wasn't the top of the pile
# NOTE: This was added as analysis was done below in the Station section
dataset$Checkout.Station <- sapply(dataset$Checkout.Station, 
                                                 function(x) gsub("RTD", "14th & Canyon", x))
dataset$Return.Station <- sapply(dataset$Return.Station, 
                                                 function(x) gsub("RTD", "14th & Canyon", x))

# Load the location data
locationset <- read.csv("Boulder Location.csv", header = TRUE)

# Peak into the data
head(dataset)

# Convert from character string into a time/date object
dataset$Checkout.Date <- strptime(dataset$Checkout.Date, "%m/%d/%Y")
dataset$Return.Date <- strptime(dataset$Return.Date, "%m/%d/%Y")
dataset$Checkout.Time <- strptime(dataset$Checkout.Time, format = "%H:%M:%S")
dataset$Return.Time <- strptime(dataset$Return.Time, format = "%H:%M:%S")

# Convert the Day of the Week into an ordered variable
dataset$Checkout.Day.of.Week <- ordered(dataset$Checkout.Day.of.Week, 
                                        levels = c("Sunday", "Monday", "Tuesday", 
                                                   "Wednesday", "Thursday", "Friday",
                                                   "Saturday"))
  
# Get the summary of the data
summary(dataset)

# View the subset of the data
subset <- subset(dataset, dataset$Rider.Home.System == "Denver B-cycle")
```

From the summary it is clear that there are some errors in the "Rider.Home.System" column.
This is supposed to be data from Boulder, so there are some errors in terms of the home system.
Subsetting the data and then glancing at the Checkout station and Return station, it is clear
that the stations are correct and the home system is wrong. Not a big deal though because this 
variable/column data is probably not that important

## Visualize data
```{r, warning = FALSE}
# Bar plot of riders with more than 200 rides
riders <- subset(dataset, 
                 Rider.or.Operator.Number %in% levels(dataset$Rider.or.Operator.Number)
                 [table(dataset$Rider.or.Operator.Number) >= 200])

ggplot(riders, aes(Rider.or.Operator.Number)) + geom_bar() + 
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  scale_y_continuous(breaks = seq(0, 10000, by = 500))

# Facet it with the Pass type
ggplot(riders, aes(Rider.or.Operator.Number)) + 
  geom_bar(aes(fill = Entry.Pass.Type)) + 
  facet_wrap(~Entry.Pass.Type, ncol = 1, scales = "free_y") + 
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + 
  guides(fill = FALSE)

# Bar plot of the post popular pass type
ggplot(dataset, aes(Entry.Pass.Type)) + 
  geom_bar(aes(fill = Entry.Pass.Type)) + 
  scale_y_continuous(breaks = seq(0, 120000, by = 2500))
```
1. Looking at riders with more than 200 rides, some riders really like to use the B-cycle for their rides. Faceting it by the pass type, we get a better understanding of what type of passes they like to use. Annual is the biggest winner among people who use the bikes often(not surprising) but there was a rider who did a little more than 200 rides using the 24 hour pass(surprised that the person didn't think of other cheaper options). 

2. The number of rides by riders using Maintenance pass is very interesting, there are a lot of rides
by a few users. This indicates that these are operators who regularly use and fix the bikes.

3. From the plots above, it is clear that the Anuual pass is definitely the most popular, followed by
the 24-hour type of rental. The 150-day and 7-day pass pale in comparison. Maintainance is another one
which has relatively high use compared to 7-day and Semester(150-day) type. This might be a good visualization for the company to use to probably change the strategy with respect to these kind of passes. 
```{r, warning = FALSE}
# Bar Plot of the bike numbers faceted by pass type
bikes <- subset(dataset, 
                Bike.Number %in% levels(dataset$Bike.Number)
                [table(dataset$Bike.Number) >= 100])

ggplot(bikes, aes(Bike.Number)) + geom_bar(aes(fill = Entry.Pass.Type)) + 
  theme(axis.text.x = element_text(angle = 90, face = "bold", size = 6)) +
  facet_wrap(~Entry.Pass.Type, ncol = 1, scales = "free_y") +
  guides(fill = FALSE)

# Bar Plot of the bike numbers faceted by day of the week
ggplot(dataset, aes(Bike.Number)) + geom_bar(aes(fill = Checkout.Day.of.Week)) + 
  theme(axis.text.x = element_text(angle = 90, face = "bold", size = 6)) +
  facet_wrap(~Checkout.Day.of.Week, ncol = 1, scales = "free_y") +
  guides(fill = FALSE)
```
Was not expecting any trends in the plot above but surprisingly there is a trend(for all pass types except for Semester type), the bike numbers in the middle(even though the text is hard to read) are the most used in all modes. They are very likely tied to the most popular stations in Boulder. 
```{r, warning = FALSE}
# Bar plot of the day of the week
ggplot(dataset, aes(Checkout.Day.of.Week)) + geom_bar() +
  guides(fill = FALSE)

# Facet by pass type
ggplot(dataset, aes(Checkout.Day.of.Week)) + geom_bar(aes(fill = Entry.Pass.Type)) +
  facet_wrap(~Entry.Pass.Type, ncol = 1, scales = "free_y") + 
  guides(fill = FALSE)
```
1. Friday is overall the most popular day of the week for ridership, followed by Thursday(surprising) and then Saturday. Monday, Tuesday & Wednesday usage is very close and Sunday usage is markedly lower compared to other days

2. When looking at the data faceted by the pass type, Annual pass holders like to use their passes on weekdays(the distribution is almost gaussian like). It is completely opposite for the users of 24-hour pass type, they like riding on weekends. Maintenance rides seems to happen mostly on weekends. Semester pass holders like to use the pass on the weekdays with Tuesday seeing the most rides. In the case of the 7-day pass there is no visible trend but Thursday is when the most rides happen with 7-day pass holders, followed by Friday and Sunday. 
```{r, warning = FALSE}
# Get a summary of Trip Duration 
summary(dataset$Trip.Duration..Minutes.)
boxplot(dataset[, 13], main = names(dataset)[13])

# Remove the negative values and convert it into positive 
# and also remove outliers(by playing around with the box plot)
duration <- subset(dataset, 
                   dataset$Trip.Duration..Minutes. > 0 & 
                   !is.na(dataset$Trip.Duration..Minutes.) &
                   dataset$Trip.Duration..Minutes. < 60 )

# The box plot looks much better after removing the outliers
boxplot(duration[, 13], main = names(dataset)[13])

# Histogram after some cleaning(remove very high values, seem like errors)
ggplot(duration, aes(Trip.Duration..Minutes.)) + 
  geom_histogram(color = "white", bins = 30) +
  scale_x_continuous(breaks = seq(0, 60, 2))

# Faceted by pass type
ggplot(duration, aes(Trip.Duration..Minutes.)) + 
  geom_histogram(color = "white", aes(fill = Entry.Pass.Type), bins = 30) +
  scale_x_continuous(breaks = seq(0, 60, 2)) + 
  theme(axis.text.x = element_text(angle = 90)) + 
  facet_grid(~Entry.Pass.Type) +
  guides(fill = FALSE)

# Faceted by day of the week
ggplot(duration, aes(Trip.Duration..Minutes.)) + 
  geom_histogram(color = "white", aes(fill = Checkout.Day.of.Week), bins = 30) +
  scale_x_continuous(breaks = seq(0, 60, 2)) + 
  theme(axis.text.x = element_text(angle = 90)) + 
  facet_grid(~Checkout.Day.of.Week) +
  guides(fill = FALSE)

# Faceted by day of the week and pass type
ggplot(duration, aes(Trip.Duration..Minutes.)) + 
  geom_histogram(color = "white", aes(fill = Checkout.Day.of.Week), bins = 30) +
  scale_x_continuous(breaks = seq(0, 60, 2)) + 
  theme(axis.text.x = element_text(angle = 90)) + 
  facet_grid(Entry.Pass.Type~Checkout.Day.of.Week, scales = "free_y") +
  guides(fill = FALSE)
```
1. Overall, the trip duration is a gaussian distribution with the max at 4-5 minutes and falls pretty hard and kind of stabilizes from the 32 minute mark. 

2. Faceting it by pass type, for the 24 hour pass type, the most common trip duration is 12-13 minutes, 10-13 minutes for 7-day pass, 4-5 minutes for Annual, 1 minute for Maintenance(quick maintenance!) and 6-7 minutes for semester type.

3. When looking at the plots by the day of the week, 5 minute period still is the most popular on weekdays but not on weekends. With 10-12 minute seeming to be more popular, may be this is due to the fact that people are not in a hurry on weekends?

4. Combining the pass type and weekday, the annual pass holders trip duration pattern doesn't change much except and point 3 still holds true. 24 hour pass type trip duration seems to be in the upper ranges, 10+ minutes. The 7-day pass doesn't show a clear pattern and difficult to gauge from the plots. 1-minute maintenance seems to be the most common turn around time. 7-8 minutes trip duration seems to still be the most common for semester type pass.
```{r, warning = FALSE}
# Bar plot of the checkout station
ggplot(dataset, aes(Checkout.Station)) + 
  geom_bar() +
  theme(axis.text.x = element_text(angle = 270)) + 
  guides(fill = FALSE)

# Bar plot of the checkout station faceted by day of the week
ggplot(dataset, aes(Checkout.Station)) + 
  geom_bar(aes(fill = Checkout.Day.of.Week)) +
  theme(axis.text.x = element_text(angle = 270)) + 
  facet_wrap(~Checkout.Day.of.Week, ncol = 1, scales = "free_y") + 
  guides(fill = FALSE)

# Bar plot of the checkout station faceted by pass type
ggplot(dataset, aes(Checkout.Station)) + 
  geom_bar(aes(fill = Entry.Pass.Type)) +
  theme(axis.text.x = element_text(angle = 270)) + 
  facet_wrap(~Entry.Pass.Type, ncol = 1, scales = "free_y") + 
  guides(fill = FALSE)

# Facet Trip duration by checkout station
ggplot(duration, aes(Trip.Duration..Minutes.)) + 
  geom_histogram(color = "white", aes(fill = Checkout.Station), bins = 30) +
  scale_x_continuous(breaks = seq(0, 60, 2)) + 
  facet_wrap(~Checkout.Station, ncol = 5) +
  guides(fill = FALSE)

# Facet Trip duration by checkout station
ggplot(duration, aes(Trip.Duration..Minutes.)) + 
  geom_histogram(color = "white", aes(fill = Return.Station), bins = 30) +
  scale_x_continuous(breaks = seq(0, 60, 2)) + 
  facet_wrap(~Return.Station, ncol = 5) +
  guides(fill = FALSE)
```
1. 15th & Pearl, 13th and Spruce are the 2 most poular check out stations in Boulder. There is a close tie between 11th and Pearl and Municipal Building stations. Greenhouse and Gunbarrel North are the least used stations, 14th and Walnut office might be an error as this location doesn't have lattitude, longitude listed

2. Faceting it by the day of the week, 15th & Pearl is still the most popular checkout station. With 13th and Spruce along with Municipal building being the 2nd most popular checkout stations from Mon-Thu and 11th & Pearl from Fri-Sun. 

3. Analyzing the checkout stations by the pass type, 15th & Pearl is still the most popular checkout station for all pass types except for the semester pass type. 

4. For the 24-hour pass type 11th and Pearl is the 2nd most popular checkout station followed by 19th @ Broadway. The village seems to be the 2nd most popular station for the 7-day pass type. The Annual pass distribution doesn't change much with the overall pattern from point 1 because this is the most popular pass type

5. There are spikes in maintenance in locations like the village and 26th @ Pearl which are not in line with the overall checkout station popularity pattern. This might indicate that the bikes there might have been subject to more rough use or a batch of bikes which were stationed there had some defect. 

6. 11th & Pearl is the most popular checkout station for the semester type pass with 15th & Pearl, 19th @ Broadway, 28th & Boulder Creek and Broadway & Euclid having checkout numbers which are close to each other. 

7. Faceting the trip duration by Checkout station there are not any major surprises and the overall pattern across the popular stations seems to be still true, ride times being in the 6-10 minutes range
```{r, warning = FALSE}
# Bar plot of the return station
ggplot(dataset, aes(Return.Station)) + 
  geom_bar() +
  theme(axis.text.x = element_text(angle = 270)) + 
  guides(fill = FALSE)

# Bar plot of the checkout station faceted by day of the week
ggplot(dataset, aes(Return.Station)) + 
  geom_bar(aes(fill = Checkout.Day.of.Week)) +
  theme(axis.text.x = element_text(angle = 270)) + 
  facet_wrap(~Checkout.Day.of.Week, ncol = 1, scales = "free_y") + 
  guides(fill = FALSE)

# Bar plot of the checkout station faceted by pass type
ggplot(dataset, aes(Return.Station)) + 
  geom_bar(aes(fill = Entry.Pass.Type)) +
  theme(axis.text.x = element_text(angle = 270)) + 
  facet_wrap(~Entry.Pass.Type, ncol = 1, scales = "free_y") + 
  guides(fill = FALSE)

# Facet Trip duration by checkout station
ggplot(duration, aes(Trip.Duration..Minutes.)) + 
  geom_histogram(color = "white", aes(fill = Return.Station), bins = 40) +
  facet_wrap(~Return.Station, ncol = 5) +
  guides(fill = FALSE)
```
No surprising changes from the Return Station analysis, most if not all of the points from the pervious section apply here as well. 
```{r, warning = FALSE}
# Plot histogram of checkout 
ggplot(dataset, aes(Checkout.Date)) + 
  geom_histogram(color = "white", bins = 50) +
  scale_x_datetime(date_labels = "%Y-%m-%d", date_breaks = "3 months") + 
  guides(fill = FALSE)

# Facet it by pass type
ggplot(dataset, aes(Checkout.Date)) + 
  geom_histogram(aes(fill = Entry.Pass.Type), color = "white", bins = 50) +
  facet_wrap(~Entry.Pass.Type, ncol = 1, scale = "free_y") + 
  scale_x_datetime(date_labels = "%Y-%m-%d", date_breaks = "3 months") + 
  guides(fill = FALSE)
```
1. The number of checkouts has progressively increased over the years from year to year. There is definitly a pattern in terms of usage with summer(May-August) months seeing an increase in checkouts but a dip on on either side. This definitely makes sense as people tend to ride less in the winter months. Among the popular summer months, July-August have the biggest checkouts across the years

2. Viewing the plots by the type of the pass, we can see that all pass types have seen an increase in usage. 7-day pass saw a big increase in the summer of 2015 and the semester type pass also saw a big increase since it was introduced in early 2014. 

3. Among the annual pass holders, October of 2015 had more users than any other month in the warmer months. This is surprising, I guess October must have been warm and also some events in the Boulder area must have caused increase ridership in a relatively colder month. 

4. Maintenance generally follows the trend of increase in number of instances of maintenance in the summer months and a decrease in the colder months. One anamoly was that in April of 2015 had the highest instances of maintenance for that year and it wasn't overall the highest month in terms of ridership. This might indicate that the Boulder B-cycle organization might be tuning up the bikes to prepare for the popular ridership months. It might be a good guess because the maintenance was lower in the months following April for 2015 across pass types.
```{r, warning = FALSE}
# Facet it by day of the week
ggplot(dataset, aes(Checkout.Date)) + 
  geom_histogram(aes(fill = Checkout.Day.of.Week), color = "white", bins = 50) +
  facet_wrap(~Checkout.Day.of.Week, ncol = 1, scale = "free_y") + 
  scale_x_datetime(date_labels = "%Y-%m-%d", date_breaks = "6 months") + 
  guides(fill = FALSE)

# Facet by pass type and day of the week
ggplot(dataset, aes(Checkout.Date)) + 
  geom_histogram(aes(fill = Checkout.Day.of.Week), color = "white", bins = 50) +
  facet_wrap(Entry.Pass.Type~Checkout.Day.of.Week, ncol = 7, scale = "free_y") + 
  scale_x_datetime(date_labels = "%Y-%m-%d", date_breaks = "4 months") + 
  theme(axis.text.x = element_text(angle = 270)) + 
  guides(fill = FALSE)
```
1. Analysing checkouts divided by the day of the week. Only Tue-Wed deviate from the general trend that August is the most popular month followed by July. In the case of Tue-Wed the roles get reversed. 

2. Doing a multivariate analysis we can see finer trends in popular days across months and across pass types. 
```{r, warning = FALSE}
# Bar plot of checkout time 
ggplot(dataset, aes(Checkout.Time)) + 
  geom_histogram(color = "white", bins = 50) +
  scale_x_datetime(date_labels = "%H:%M", date_breaks = "30 min") + 
  guides(fill = FALSE)

# Bar plot of return time
ggplot(dataset, aes(Return.Time)) + 
  geom_histogram(color = "white", bins = 50) +
  facet_wrap(~Entry.Pass.Type, ncol = 1, scale = "free_y") +
  scale_x_datetime(date_labels = "%H:%M", date_breaks = "30 min") + 
  guides(fill = FALSE)

# Bar plot of checkout time faceted by pass type 
ggplot(dataset, aes(Checkout.Time)) + 
  geom_histogram(aes(fill = Entry.Pass.Type), color = "white", bins = 50) +
  facet_wrap(~Entry.Pass.Type, ncol = 1, scale = "free_y") +
  scale_x_datetime(date_labels = "%H:%M", date_breaks = "30 min") + 
  guides(fill = FALSE)

# Bar plot of return time faceted by pass type 
ggplot(dataset, aes(Return.Time)) + 
  geom_histogram(aes(fill = Entry.Pass.Type), color = "white", bins = 50) +
  facet_wrap(~Entry.Pass.Type, ncol = 1, scale = "free_y") +
  scale_x_datetime(date_labels = "%H:%M", date_breaks = "30 min") + 
  guides(fill = FALSE)

# Facet by pass type and day of the week
ggplot(dataset, aes(Checkout.Time)) + 
  geom_histogram(aes(fill = Checkout.Day.of.Week), color = "white", bins = 50) +
  facet_wrap(Entry.Pass.Type~Checkout.Day.of.Week, ncol = 7, scale = "free_y") + 
  scale_x_datetime(date_labels = "%Y-%m-%d", date_breaks = "4 months") + 
  theme(axis.text.x = element_text(angle = 270)) + 
  guides(fill = FALSE)

ggplot(dataset, aes(Return.Time)) + 
  geom_histogram(aes(fill = Checkout.Day.of.Week), color = "white", bins = 50) +
  facet_wrap(Entry.Pass.Type~Checkout.Day.of.Week, ncol = 7, scale = "free_y") + 
  scale_x_datetime(date_labels = "%Y-%m-%d", date_breaks = "4 months") + 
  theme(axis.text.x = element_text(angle = 270)) + 
  guides(fill = FALSE)
```
1. Checkout/Return times start slowly a little before 7(expected), with a big increase just after 7:00. From then on the trend is that returns slightly decrease from 7 then increase from 10:00 to 11:15, then seeing a dip at around 13:00 followed by an increase till 15:00. There is a dip again with an increase in ridership after 18:00. The return and checkout times follow each other closely because the overall most popular times in Boulder is less than 10 minutes.

2. 24 hour pass type holders checkout/return times start off strong in the morning and slowly decrease except for one small spike at 10:00 and then start increasing at 2:30, hitting a peak at 18:00 and then slowly decreasing.

3. Among 7-day pass holders 14:30 seems to be the peak for checkout/returns. The increase in checkout/return starts at around 11:30. The pattern seems to be similar for semester pass holders. 

4. Annual pass holder pattern follows the overall pattern described in point 1. The peak maintenance times is in the morning before 11:00 followed by a big dip and then a big increase after 15:00  

```{r, warning =  FALSE}
# Facet by pass type and day of the week
ggplot(dataset, aes(Checkout.Time)) + 
  geom_histogram(aes(fill = Checkout.Day.of.Week), color = "white", bins = 50) +
  facet_wrap(Entry.Pass.Type~Checkout.Day.of.Week, ncol = 7, scale = "free_y") + 
  scale_x_datetime(date_labels = "%H:%M", date_breaks = "2 hour") + 
  theme(axis.text.x = element_text(angle = 270)) + 
  guides(fill = FALSE)

ggplot(dataset, aes(Return.Time)) + 
  geom_histogram(aes(fill = Checkout.Day.of.Week), color = "white", bins = 50) +
  facet_wrap(Entry.Pass.Type~Checkout.Day.of.Week, ncol = 7, scale = "free_y") + 
  scale_x_datetime(date_labels = "%H:%M", date_breaks = "2 hour") + 
  theme(axis.text.x = element_text(angle = 270)) + 
  guides(fill = FALSE)
```
1. Among 24 hour pass holders from Tue-Thu the checkout/return pattern is different from Fri-Mon. Tue-Thu checkout/returns doesn't dip as much in the middle of the day compared to Fri-Mon.

2. 7-day pass checkout/returns peak at around 15:00 from Mon-Thu, with Fri-Sun seeing peaks and drops throughout the day. The same pattern applies for semester pass holders. 

3. Annual pass holders like to use the service in 11:00, 15:00 and 18:00 time periods on weekdays. Where as on Saturdays and Sundays see peak usage in the morning and evenings

4. Maintenance peaks at 15:00 on weekdays but mornings and evenings on Saturdays and Sunday. There is a big drop in maintenance in the middle of weekends. 
```{r, warning = FALSE}
# Get the map of Boulder, CO
map = get_map(location = "Boulder, Colorado", zoom = 13, maptype = "terrain")

# Convert the location access count into a table
checkoutcount <- as.data.frame(table(dataset$Checkout.Station))
returncount <- as.data.frame(table(dataset$Return.Station))

# Add a new column for checkout count and return count
locationset["Checkout.Count"] <- NA
locationset["Return.Count"] <- NA

# Go through each element of the locationcount data frame and add the count
# corresponding to the location
for (i in 1:nrow(checkoutcount)){
  indextoadd <- grep(checkoutcount[i, "Var1"], locationset$Checkout.Station)
  locationset[indextoadd, "Checkout.Count"] <- checkoutcount[i, "Freq"]
}

for (i in 1:nrow(returncount)){
  indextoadd <- grep(returncount[i, "Var1"], locationset$Return.Station)
  locationset[indextoadd, "Return.Count"] <- returncount[i, "Freq"]
}

# Pass in the map object for plotting a heat map of the checkout stations
ggmap(map) +
  geom_point(data = locationset, 
             aes(y = Checkout.Station.Latitude, 
                 x = Checkout.Station.Longitude,
                 size = Checkout.Count),
             color = "red", alpha = 0.5) +
  scale_size(range = c(0, 15)) + 
  guides(fill = FALSE)

# Heat map of the return stations
ggmap(map) +
  geom_point(data = locationset, 
             aes(y = Checkout.Station.Latitude, 
                 x = Checkout.Station.Longitude,
                 size = Return.Count),
             color = "red", alpha = 0.5) +
  scale_size(range = c(0, 15)) + 
  guides(fill = FALSE)
```
The maps above show what the most popular checkout/return stations are in Boulder. The size of the circle represents the overall checkouts/returns since B-cycle started.

# Machine Learning to predict the pass type
```{r, warning = FALSE}
# Subset the data keeping the necessary variables
mlsubset <- dataset[c(3, 13)]

# Create partition
trainIndex <- createDataPartition(mlsubset$Entry.Pass.Type, p = 0.8, list = FALSE, times = 1)
trainingset <- mlsubset[trainIndex, ]
testset <- mlsubset[-trainIndex, ]

# Get the necessary variables for analysis
# Split the data set for 10-fold cross validation, train on 9, test on 1 for all combinations
trainControl <- trainControl(method = "cv", number = 10)
metric <- "Accuracy"

# Evaluate 3 different algorithms, make sure the same seed is used
# Linear Discriminant Analysis
set.seed(7)
fit.lda <- train(Entry.Pass.Type~., data = trainingset, method = "lda", 
                 metric = metric, trControl = trainControl)
# Classification and Regression Test
set.seed(7)
fit.cart <- train(Entry.Pass.Type~., data = trainingset, method = "rpart", 
                  metric = metric, trControl = trainControl)
# Naive Bayes
set.seed(7)
fit.nb <- train(Entry.Pass.Type~., data = trainingset, method = "nb", 
                 metric = metric, trControl = trainControl)

# Summarize accuracy of models
results <- resamples(list(lda = fit.lda, cart = fit.cart, nb = fit.nb))
summary(results)

# Dot plot of the results
dotplot(results)

# Compare against the test set
predictions <- predict(fit.cart, testset)
confusionMatrix(predictions, testset$Entry.Pass.Type)
```